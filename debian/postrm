#!/bin/bash
#DEBHELPER#
set -e

#. /var/lib/dpkg/info/tm-manifest.post-args-parser $1

TMMS_SRC=/usr/lib/python3/dist-packages/tmms
TMMS_CFG_DIR=/etc/tmms

IsInstall=false
IsAbortInstall=false
IsConfigure=false

IsRemove=false
IsPurge=false
IsAbortRemove=false

for arg in "$@"
do
case $arg in
    remove)
        IsRemove=true
        shift
    ;;
    purge)
        IsPurge=true
        shift
    ;;
    abort-remove)
        IsAbortRemove=true
        shift
    ;;
    *)
    ;;
esac
done


if [ "$IsRemove" ]; then
    if [ -d "$TMMS_SRC" ]; then
        echo "Removing dist-packages/tmms/ with a postrm script..."
        rm -r $TMMS_SRC
    fi

    # --------- UNLINK /usr/bin/ stuff ---------

    if [ -e "/usr/bin/tm-manifest" ]; then
        unlink /usr/bin/tm-manifest
    fi
    if [ -e "/usr/bin/tm-manifest-server" ]; then
        unlink /usr/bin/tm-manifest-server
    fi
    if [ -e "/usr/bin/tm-manifest-setup" ]; then
        unlink /usr/bin/tm-manifest-setup
    fi

fi # if IsRemove


if [ "$IsPurge" ]; then
    if [ -d "$TMMS_CFG" ]; then
        echo "Moving $TMMS_CFG to /etc/tmms.purge with a postrm script..."
        mv $TMMS_CFG /tmp/tmms.purge
    fi
fi # if IsRemove
